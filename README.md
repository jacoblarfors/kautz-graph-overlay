# kautz-graph-overlay
An overlay network using a static kautz graph implemented on Node.js. Cuurently only identifier generation is supported in any system.

This version was built to acomodate setup to the University of Helsinki Computer Science dept. Ukko HCP-cluster. If you wish to test it make sure you have the proper access rights.

# Usage
In preparation to set up a kautz-overlay on the Ukko cluster make sure you have extracted the proper files:

	´´´
	kautz-master.js
	kautz-node.js
	kautz-intermediate.js
	´´´

Make sure you have npm packages async and anybase installed:

	´´´
	$> npm install async
	$> npm install anybase
	´´´

Choose some (preferably four) Ukko-nodes to host the nodes. Make sure you can log into the nodes without having to type your password, i.e. you must have valid priv/pub keypair access from origin host to the cluster AND an ssh-agent running with the identity added:

	´´´
	$> ssh-agent bash
	$> ssh-add
	´´´

# Setting up the network
To set up the network enter the directory to which the aforementioned files were extracted and to which anyc and anybase were installed. Then start the network by starting the kautz-master.js, for example:
	$> node kautz-master.js 51000 2 10 ukko144 ukko141 ukko014 ukko110

The network of K(2, 10) containing 1536 kautz-nodes is set up and a listing of nodes and their respective kautz-identifiers, hosts and ports is printed. After a while the master exits and the network is guaranteed to be up. If there were error messages the network naturally wasn't fully set up and you should check the availability of connections on the cluster, the availability of the hosts and the number of processes available to forking. Before trying again make sure you follow the instructions in 'Shutdown' to shutdown the incomplete network.

If the network was fully set up you can telnet to any node in the network, use the listing that was generated by the master. To route a message in the network you must give a JSON formatted string to the node you connected to. For example, to route a message from any node to a node with identifier 1212121212, in the telnet prompt type:

	´´´
	$> telnet ukkoXXX.hpc.cs.helsinki.fi <port>
	Trying xx.xx.xx.xx...
	Connected to ukkoXXX.hpc.cs.helsinki.fi
	Escape character is '^]'.
	{"destination":"1212121212"}
	´´´

It will take a while to route the message through the network, but at some point you should be able to check the logfiles of the source node, excpected intermediate nodes and finally the destination node (which should now contain the relevant routed message along with statistics and path listing). All logging will be put into the directory ~/kautz-logs/, error and output logging in separate files, one of each per kautz-node.

# Shutdown
Currenctly there is no clean mechanism to shutdown the network by, for example, issuing a STOP command via telnet. The feature has been built but is not yet fully functional and should not be trusted to provide coherent results.

To shutdown the network you need to issue a kill command to each process, for example:

	´´´
	$> ssh ukkoXXX.hpc killall node
	´´´

Will terminate all node processes on ukkoXXX node. This should be relatively straight forward but the author cannot guarantee that no other processes are terminated if the reader should have other node processes running at the particular host(s).
